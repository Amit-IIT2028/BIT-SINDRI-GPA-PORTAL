<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>BIT Sindri Grade Portal</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
  /* ---------- BASE ---------- */
  body {
    margin: 0;
    font-family: Times New Roman;
    color: white;
    text-align: center;
    background: none;
    overflow-x: hidden;
  }

  /* ---------- BLURRED BACKGROUND ---------- */
  .background {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-image: url("1000063709 (1).avif");
    background-size: cover;
    background-position: center;
    filter: blur(18px);
    transform: scale(1.1);
    z-index: -2;
  }

  .overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(0, 0, 0, 0.55);
    z-index: -1;
  }

  /* ---------- LOGO ---------- */
  .logo {
    position: fixed;
    top: 15px;
    left: 15px;
    z-index: 5;
  }

  .logo img {
    height: 110px;
    max-width: 100%;
  }

  h1 {
    margin-top: 20px;
  }

  .container {
    max-width: 1000px;
    margin: auto;
    padding: 20px;
  }

  input, select, button {
    padding: 8px;
    margin: 6px;
    font-size: 1em;
    border-radius: 4px;
    border: none;
  }

  button {
    background: #1e40af;
    color: white;
    cursor: pointer;
  }

  button:hover {
    background: #2563eb;
  }

  table {
    width: 100%;
    margin-top: 20px;
    border-collapse: collapse;
    background: rgba(255,255,255,0.08);
    backdrop-filter: blur(6px);
  }

  th, td {
    border: 1px solid #aaa;
    padding: 8px;
  }

  .result {
    margin-top: 20px;
    font-size: 1.5em;
    white-space: pre-line;
  }

  .footer {
    margin-top: 30px;
    font-size: 1.30em;
    color: #ccc;
  }

  /* ---------- MOBILE ---------- */
  @media (max-width: 600px) {
    table {
      font-size: 0.9em;
    }
    input {
      width: 90%;
    }
    .logo img {
      height: 80px;
    }
  }
</style>
</head>

<body oncontextmenu="return false">

<!-- Background layers -->
<div class="background"></div>
<div class="overlay"></div>

<!-- LOGO -->
<div class="logo">
  <img src="seventyfive (1).png" alt="BIT Sindri 75 Years Logo">
</div>

<h1>BIT Sindri Grade Portal</h1>

<div class="container">

  <label><strong>Registration / Roll Number</strong></label><br>
  <input type="text" id="regNo" placeholder="Enter registration number"
         onblur="loadSemesterData()">

  <br><br>

  <label><strong>Semester</strong></label><br>
  <select id="semester" onchange="loadSemesterData()">
    <option value="1">Semester 1</option>
    <option value="2">Semester 2</option>
    <option value="3">Semester 3</option>
    <option value="4">Semester 4</option>
    <option value="5">Semester 5</option>
    <option value="6">Semester 6</option>
    <option value="7">Semester 7</option>
    <option value="8">Semester 8</option>
  </select>

  <br>
  <button onclick="addRow()">Add Subject</button>

  <table>
    <thead>
      <tr>
        <th>Subject Name</th>
        <th>Credits</th>
        <th>Grade</th>
      </tr>
    </thead>
    <tbody id="tableBody"></tbody>
  </table>

  <br>
  <button onclick="calculateAndSaveSGPA()">Calculate & Save SGPA</button>
  <button onclick="calculateCGPA()">Calculate CGPA</button>

  <div class="result" id="result"></div>

  <div class="footer">
    <div>Created by Amit Dhar, Mechanical 2022-26 Batch</div>
    
    <div>
      Disclaimer: This website does not store anyone’s data on any server.
      All information is saved only in your browser.
    </div>
    <div>Dedicated to the betterment of BIT Sindri.</div>
    <div>© All rights reserved</div>
  </div>

</div>

<script>
/* ---------- GRADE POINT SYSTEM ---------- */
const gradePoints = {
  "A+": 10,
  "A": 9,
  "B+": 8,
  "B": 7,
  "C+": 6,
  "C": 5,
  "F": 0
};

/* ---------- LOAD SEMESTER DATA ---------- */
function loadSemesterData() {
  const regNo = document.getElementById("regNo").value.trim();
  const sem = document.getElementById("semester").value;
  const tbody = document.getElementById("tableBody");

  tbody.innerHTML = "";
  if (!regNo) return;

  const data = JSON.parse(localStorage.getItem(regNo));
  if (!data || !data[sem] || !data[sem].subjects) return;

  data[sem].subjects.forEach(sub => {
    tbody.insertAdjacentHTML("beforeend", createRow(sub.name, sub.credit, sub.grade));
  });
}

/* ---------- ADD SUBJECT ROW ---------- */
function addRow() {
  document.getElementById("tableBody")
    .insertAdjacentHTML("beforeend", createRow("", "", "A"));
}

/* ---------- ROW TEMPLATE ---------- */
function createRow(name, credit, grade) {
  return `
    <tr>
      <td><input type="text" value="${name || ""}"></td>
      <td><input type="number" step="0.5" value="${credit || ""}"></td>
      <td>
        <select>
          ${Object.keys(gradePoints)
            .map(g => `<option ${g===grade?"selected":""}>${g}</option>`)
            .join("")}
        </select>
      </td>
    </tr>
  `;
}

/* ---------- CALCULATE & SAVE SGPA ---------- */
function calculateAndSaveSGPA() {
  const regNo = document.getElementById("regNo").value.trim();
  const sem = document.getElementById("semester").value;
  const rows = document.querySelectorAll("#tableBody tr");

  if (!regNo) {
    alert("Enter registration number");
    return;
  }

  let semCredits = 0;
  let weightedSum = 0;
  let subjects = [];

  rows.forEach(row => {
    const name = row.cells[0].children[0].value;
    const credit = Number(row.cells[1].children[0].value) || 0;
    const grade = row.cells[2].children[0].value;

    subjects.push({ name, credit, grade });
    weightedSum += credit * gradePoints[grade];
    semCredits += credit;
  });

  if (semCredits === 0) {
    alert("Enter subject credits");
    return;
  }

  const sgpa = weightedSum / semCredits;

  let data = JSON.parse(localStorage.getItem(regNo)) || {};
  data[sem] = {
    sgpa: Number(sgpa.toFixed(4)),
    credits: Number(semCredits),
    subjects
  };

  localStorage.setItem(regNo, JSON.stringify(data));

  document.getElementById("result").innerText =
    `SGPA (Semester ${sem}): ${sgpa.toFixed(2)}\nSaved Successfully`;
}

/* ---------- CGPA ---------- */
function calculateCGPA() {
  const regNo = document.getElementById("regNo").value.trim();
  if (!regNo) {
    alert("Enter registration number");
    return;
  }

  const data = JSON.parse(localStorage.getItem(regNo));
  if (!data) {
    document.getElementById("result").innerText =
      "No semester data found.";
    return;
  }

  let totalWeighted = 0;
  let totalCredits = 0;

  Object.values(data).forEach(sem => {
    if (!isNaN(sem.sgpa) && !isNaN(sem.credits)) {
      totalWeighted += sem.sgpa * sem.credits;
      totalCredits += sem.credits;
    }
  });

  const cgpa = totalCredits
    ? (totalWeighted / totalCredits).toFixed(2)
    : "0.00";

  document.getElementById("result").innerText =
    `Final CGPA: ${cgpa}\nThank you, Visit Again!!!`;
}
</script>

</body>
</html>
